{"ast":null,"code":"var _jsxFileName = \"/Users/tranquocphipq/Documents/workspace/Other-source/ReactJS/src/pages/OAuth2Popup/OAuth2Popup.jsx\",\n  _s = $RefreshSig$();\n// OAuth2Popup.jsx\nimport { useEffect } from 'react';\nimport { queryToObject } from './tools';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst OAUTH_STATE_KEY = 'react-use-oauth2-state-key';\nconst OAUTH_RESPONSE = 'react-use-oauth2-response';\nconst OAuthPopup = props => {\n  _s();\n  const checkState = receivedState => {\n    const state = sessionStorage.getItem(OAUTH_STATE_KEY);\n    return state === receivedState;\n  };\n  const queryToObject = query => {\n    const parameters = new URLSearchParams(query);\n    return Object.fromEntries(parameters.entries());\n  };\n  const {\n    Component = /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        margin: '12px'\n      },\n      \"data-testid\": \"popup-loading\",\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 22,\n      columnNumber: 4\n    }, this)\n  } = props;\n  // On mount\n  useEffect(() => {\n    const payload = queryToObject(window.location.search.split('?')[1]);\n    const state = payload && payload.state;\n    const error = payload && payload.error;\n    if (!window.opener) {\n      throw new Error('No window opener');\n    }\n    if (error) {\n      window.opener.postMessage({\n        type: OAUTH_RESPONSE,\n        error: decodeURI(error) || 'OAuth error: An error has occured.'\n      });\n    } else if (state && checkState(state)) {\n      window.opener.postMessage({\n        type: OAUTH_RESPONSE,\n        payload\n      });\n    } else {\n      window.opener.postMessage({\n        type: OAUTH_RESPONSE,\n        error: 'OAuth error: State mismatch.'\n      });\n    }\n  }, []);\n  return Component;\n};\n_s(OAuthPopup, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n_c = OAuthPopup;\nexport default OAuthPopup;\nvar _c;\n$RefreshReg$(_c, \"OAuthPopup\");","map":{"version":3,"names":["useEffect","queryToObject","jsxDEV","_jsxDEV","OAUTH_STATE_KEY","OAUTH_RESPONSE","OAuthPopup","props","_s","checkState","receivedState","state","sessionStorage","getItem","query","parameters","URLSearchParams","Object","fromEntries","entries","Component","style","margin","children","fileName","_jsxFileName","lineNumber","columnNumber","payload","window","location","search","split","error","opener","Error","postMessage","type","decodeURI","_c","$RefreshReg$"],"sources":["/Users/tranquocphipq/Documents/workspace/Other-source/ReactJS/src/pages/OAuth2Popup/OAuth2Popup.jsx"],"sourcesContent":["// OAuth2Popup.jsx\nimport { useEffect } from 'react';\nimport { queryToObject } from './tools';\n\nconst OAUTH_STATE_KEY = 'react-use-oauth2-state-key';\nconst OAUTH_RESPONSE = 'react-use-oauth2-response';\n\n\n\nconst OAuthPopup = (props) => {\n    const checkState = (receivedState) => {\n        const state = sessionStorage.getItem(OAUTH_STATE_KEY);\n        return state === receivedState;\n    };\n    \n    const queryToObject = (query) => {\n        const parameters = new URLSearchParams(query);\n        return Object.fromEntries(parameters.entries());\n    };\n\tconst {\n\t\tComponent = (\n\t\t\t<div style={{ margin: '12px' }} data-testid=\"popup-loading\">\n\t\t\t\tLoading...\n\t\t\t</div>\n\t\t),\n\t} = props;\n    // On mount\n\tuseEffect(() => {\n\t\tconst payload = queryToObject(window.location.search.split('?')[1]);\n\t\tconst state = payload && payload.state;\n\t\tconst error = payload && payload.error;\n\n\t\tif (!window.opener) {\n\t\t\tthrow new Error('No window opener');\n\t\t}\n\n        if (error) {\n\t\t\twindow.opener.postMessage({\n\t\t\t\ttype: OAUTH_RESPONSE,\n\t\t\t\terror: decodeURI(error) || 'OAuth error: An error has occured.',\n\t\t\t});\n\t\t} else if (state && checkState(state)) {\n\t\t\twindow.opener.postMessage({\n\t\t\t\ttype: OAUTH_RESPONSE,\n\t\t\t\tpayload,\n\t\t\t});\n\t\t} else {\n\t\t\twindow.opener.postMessage({\n\t\t\t\ttype: OAUTH_RESPONSE,\n\t\t\t\terror: 'OAuth error: State mismatch.',\n\t\t\t});\n\t\t}\n\t}, []);\n\n\treturn Component;\n};\n\nexport default OAuthPopup;\n"],"mappings":";;AAAA;AACA,SAASA,SAAS,QAAQ,OAAO;AACjC,SAASC,aAAa,QAAQ,SAAS;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExC,MAAMC,eAAe,GAAG,4BAA4B;AACpD,MAAMC,cAAc,GAAG,2BAA2B;AAIlD,MAAMC,UAAU,GAAIC,KAAK,IAAK;EAAAC,EAAA;EAC1B,MAAMC,UAAU,GAAIC,aAAa,IAAK;IAClC,MAAMC,KAAK,GAAGC,cAAc,CAACC,OAAO,CAACT,eAAe,CAAC;IACrD,OAAOO,KAAK,KAAKD,aAAa;EAClC,CAAC;EAED,MAAMT,aAAa,GAAIa,KAAK,IAAK;IAC7B,MAAMC,UAAU,GAAG,IAAIC,eAAe,CAACF,KAAK,CAAC;IAC7C,OAAOG,MAAM,CAACC,WAAW,CAACH,UAAU,CAACI,OAAO,EAAE,CAAC;EACnD,CAAC;EACJ,MAAM;IACLC,SAAS,gBACRjB,OAAA;MAAKkB,KAAK,EAAE;QAAEC,MAAM,EAAE;MAAO,CAAE;MAAC,eAAY,eAAe;MAAAC,QAAA,EAAC;IAE5D;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAEF,CAAC,GAAGpB,KAAK;EACN;EACHP,SAAS,CAAC,MAAM;IACf,MAAM4B,OAAO,GAAG3B,aAAa,CAAC4B,MAAM,CAACC,QAAQ,CAACC,MAAM,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IACnE,MAAMrB,KAAK,GAAGiB,OAAO,IAAIA,OAAO,CAACjB,KAAK;IACtC,MAAMsB,KAAK,GAAGL,OAAO,IAAIA,OAAO,CAACK,KAAK;IAEtC,IAAI,CAACJ,MAAM,CAACK,MAAM,EAAE;MACnB,MAAM,IAAIC,KAAK,CAAC,kBAAkB,CAAC;IACpC;IAEM,IAAIF,KAAK,EAAE;MAChBJ,MAAM,CAACK,MAAM,CAACE,WAAW,CAAC;QACzBC,IAAI,EAAEhC,cAAc;QACpB4B,KAAK,EAAEK,SAAS,CAACL,KAAK,CAAC,IAAI;MAC5B,CAAC,CAAC;IACH,CAAC,MAAM,IAAItB,KAAK,IAAIF,UAAU,CAACE,KAAK,CAAC,EAAE;MACtCkB,MAAM,CAACK,MAAM,CAACE,WAAW,CAAC;QACzBC,IAAI,EAAEhC,cAAc;QACpBuB;MACD,CAAC,CAAC;IACH,CAAC,MAAM;MACNC,MAAM,CAACK,MAAM,CAACE,WAAW,CAAC;QACzBC,IAAI,EAAEhC,cAAc;QACpB4B,KAAK,EAAE;MACR,CAAC,CAAC;IACH;EACD,CAAC,EAAE,EAAE,CAAC;EAEN,OAAOb,SAAS;AACjB,CAAC;AAACZ,EAAA,CA9CIF,UAAU;AAAAiC,EAAA,GAAVjC,UAAU;AAgDhB,eAAeA,UAAU;AAAC,IAAAiC,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}