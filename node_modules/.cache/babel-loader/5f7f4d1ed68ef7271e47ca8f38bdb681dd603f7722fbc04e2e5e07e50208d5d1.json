{"ast":null,"code":"var _jsxFileName = \"/Users/tranquocphipq/Documents/workspace/Other-source/ReactJS/src/pages/OAuth2Popup/OAuth2Popup.jsx\",\n  _s = $RefreshSig$();\n// OAuth2Popup.jsx\nimport { useEffect } from 'react';\nimport { queryToObject } from './tools';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst OAUTH_STATE_KEY = 'react-use-oauth2-state-key';\nconst OAUTH_RESPONSE = 'react-use-oauth2-response';\nconst checkState = receivedState => {\n  const state = sessionStorage.getItem(OAUTH_STATE_KEY);\n  return state === receivedState;\n};\nconst OAuthPopup = props => {\n  _s();\n  const {\n    Component = /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        margin: '12px'\n      },\n      \"data-testid\": \"popup-loading\",\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 4\n    }, this)\n  } = props;\n  // On mount\n  useEffect(() => {\n    const payload = queryToObject(window.location.search.split('?')[1]);\n    const state = payload && payload.state;\n    const error = payload && payload.error;\n    if (!window.opener) {\n      throw new Error('No window opener');\n    }\n    if (error) {\n      window.opener.postMessage({\n        type: OAUTH_RESPONSE,\n        error: decodeURI(error) || 'OAuth error: An error has occured.'\n      });\n    } else if (state && checkState(state)) {\n      window.opener.postMessage({\n        type: OAUTH_RESPONSE,\n        payload\n      });\n    } else {\n      window.opener.postMessage({\n        type: OAUTH_RESPONSE,\n        error: 'OAuth error: State mismatch.'\n      });\n    }\n  }, []);\n  return Component;\n};\n_s(OAuthPopup, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n_c = OAuthPopup;\nexport default OAuthPopup;\nvar _c;\n$RefreshReg$(_c, \"OAuthPopup\");","map":{"version":3,"names":["useEffect","queryToObject","jsxDEV","_jsxDEV","OAUTH_STATE_KEY","OAUTH_RESPONSE","checkState","receivedState","state","sessionStorage","getItem","OAuthPopup","props","_s","Component","style","margin","children","fileName","_jsxFileName","lineNumber","columnNumber","payload","window","location","search","split","error","opener","Error","postMessage","type","decodeURI","_c","$RefreshReg$"],"sources":["/Users/tranquocphipq/Documents/workspace/Other-source/ReactJS/src/pages/OAuth2Popup/OAuth2Popup.jsx"],"sourcesContent":["// OAuth2Popup.jsx\nimport { useEffect } from 'react';\nimport { queryToObject } from './tools';\n\nconst OAUTH_STATE_KEY = 'react-use-oauth2-state-key';\nconst OAUTH_RESPONSE = 'react-use-oauth2-response';\n\n\nconst checkState = (receivedState) => {\n\tconst state = sessionStorage.getItem(OAUTH_STATE_KEY);\n\treturn state === receivedState;\n};\n\n\nconst OAuthPopup = (props) => {\n\tconst {\n\t\tComponent = (\n\t\t\t<div style={{ margin: '12px' }} data-testid=\"popup-loading\">\n\t\t\t\tLoading...\n\t\t\t</div>\n\t\t),\n\t} = props;\n    // On mount\n\tuseEffect(() => {\n\t\tconst payload = queryToObject(window.location.search.split('?')[1]);\n\t\tconst state = payload && payload.state;\n\t\tconst error = payload && payload.error;\n\n\t\tif (!window.opener) {\n\t\t\tthrow new Error('No window opener');\n\t\t}\n\n        if (error) {\n\t\t\twindow.opener.postMessage({\n\t\t\t\ttype: OAUTH_RESPONSE,\n\t\t\t\terror: decodeURI(error) || 'OAuth error: An error has occured.',\n\t\t\t});\n\t\t} else if (state && checkState(state)) {\n\t\t\twindow.opener.postMessage({\n\t\t\t\ttype: OAUTH_RESPONSE,\n\t\t\t\tpayload,\n\t\t\t});\n\t\t} else {\n\t\t\twindow.opener.postMessage({\n\t\t\t\ttype: OAUTH_RESPONSE,\n\t\t\t\terror: 'OAuth error: State mismatch.',\n\t\t\t});\n\t\t}\n\t}, []);\n\n\treturn Component;\n};\n\nexport default OAuthPopup;\n"],"mappings":";;AAAA;AACA,SAASA,SAAS,QAAQ,OAAO;AACjC,SAASC,aAAa,QAAQ,SAAS;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExC,MAAMC,eAAe,GAAG,4BAA4B;AACpD,MAAMC,cAAc,GAAG,2BAA2B;AAGlD,MAAMC,UAAU,GAAIC,aAAa,IAAK;EACrC,MAAMC,KAAK,GAAGC,cAAc,CAACC,OAAO,CAACN,eAAe,CAAC;EACrD,OAAOI,KAAK,KAAKD,aAAa;AAC/B,CAAC;AAGD,MAAMI,UAAU,GAAIC,KAAK,IAAK;EAAAC,EAAA;EAC7B,MAAM;IACLC,SAAS,gBACRX,OAAA;MAAKY,KAAK,EAAE;QAAEC,MAAM,EAAE;MAAO,CAAE;MAAC,eAAY,eAAe;MAAAC,QAAA,EAAC;IAE5D;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAEF,CAAC,GAAGT,KAAK;EACN;EACHZ,SAAS,CAAC,MAAM;IACf,MAAMsB,OAAO,GAAGrB,aAAa,CAACsB,MAAM,CAACC,QAAQ,CAACC,MAAM,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IACnE,MAAMlB,KAAK,GAAGc,OAAO,IAAIA,OAAO,CAACd,KAAK;IACtC,MAAMmB,KAAK,GAAGL,OAAO,IAAIA,OAAO,CAACK,KAAK;IAEtC,IAAI,CAACJ,MAAM,CAACK,MAAM,EAAE;MACnB,MAAM,IAAIC,KAAK,CAAC,kBAAkB,CAAC;IACpC;IAEM,IAAIF,KAAK,EAAE;MAChBJ,MAAM,CAACK,MAAM,CAACE,WAAW,CAAC;QACzBC,IAAI,EAAE1B,cAAc;QACpBsB,KAAK,EAAEK,SAAS,CAACL,KAAK,CAAC,IAAI;MAC5B,CAAC,CAAC;IACH,CAAC,MAAM,IAAInB,KAAK,IAAIF,UAAU,CAACE,KAAK,CAAC,EAAE;MACtCe,MAAM,CAACK,MAAM,CAACE,WAAW,CAAC;QACzBC,IAAI,EAAE1B,cAAc;QACpBiB;MACD,CAAC,CAAC;IACH,CAAC,MAAM;MACNC,MAAM,CAACK,MAAM,CAACE,WAAW,CAAC;QACzBC,IAAI,EAAE1B,cAAc;QACpBsB,KAAK,EAAE;MACR,CAAC,CAAC;IACH;EACD,CAAC,EAAE,EAAE,CAAC;EAEN,OAAOb,SAAS;AACjB,CAAC;AAACD,EAAA,CArCIF,UAAU;AAAAsB,EAAA,GAAVtB,UAAU;AAuChB,eAAeA,UAAU;AAAC,IAAAsB,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}